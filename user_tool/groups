# This configuration file follows a specific structure for defining groups of system calls with parameters:
# - Arguments must be defined before groups with "a:" and "()" brackets.
# - Parameters are allowed only within groups and are specified with "p:" and "[]" brackets.
# - Each group starts with the system call number on each line and are specified with "g:" and "{}" brackets.
# - Parameters are asked sequentially, they need to end with "?".
# - Each grouping can use a default questions for when no match occurs, specified with "d:".
# - Once all arguments for a system call hit, the question is thrown.
# - Values for parameter must be declared as arguments and assigned using "=".

# --- Arguments Communication ---

a: socket-domain-internet (
  AF_INET
  AF_INET6
)

a: socket-domain-intern (
  AF_UNIX
  AF_NETLINK
)

a: socket-type-tcp (
  SOCK_STREAM
)

a: socket-type-udp (
  SOCK_DGRAM
)

a: socket-type-any (
  SOCK_STREAM 
  SOCK_DGRAM
  SOCK_RAW
)

# --- Grouping Communication ---

g: PipeCommunication {
  d: Do you allow communication between processes using pipes
  
  22 pipe(int pipefd[2])
  293 pipe2(int pipefd[2], int flags)
}

g: SocketCommunication {
  d: Do you allow communication using sockets

  41 socket(int domain, int type, int protocol)
  53 socketpair(int domain, int type, int protocol, int sv[2])

  p: Do you allow communication over the internet, connection-oriented?? [
    domain = socket-domain-internet
    type = socket-type-tcp
  ]

  p: Do you allow communication over the internet, connectionless? [
    domain = socket-domain-internet
    type = socket-type-udp
  ]

  p: Do you allow local communication using sockets? [
    domain = socket-domain-intern
    type = socket-type-any
  ]

}